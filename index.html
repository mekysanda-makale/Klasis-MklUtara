<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root { --primary: #2c3e50; --accent: #3498db; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
    .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
    h2 { color: var(--primary); border-bottom: 2px solid var(--accent); padding-bottom: 10px; }
    .hidden { display: none; }
    .question-card { margin-bottom: 30px; padding: 20px; border: 1px solid #eee; border-radius: 8px; transition: 0.3s; }
    .question-card:hover { border-color: var(--accent); }
    .question-text { font-weight: 600; margin-bottom: 15px; display: block; line-height: 1.5; }
    .options-group { display: flex; flex-direction: column; gap: 10px; }
    .option-item { display: flex; align-items: flex-start; gap: 10px; cursor: pointer; }
    .sub-panel { margin-top: 15px; padding: 15px; background: #f8f9fa; border-left: 4px solid var(--accent); border-radius: 4px; }
    input[type="text"], select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
    button { background: var(--accent); color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 16px; width: 100%; margin-top: 20px; }
    button:hover { background: #2980b9; }
    .header-survey { text-align: center; margin-bottom: 30px; }
  </style>
</head>
<body>

<div class="container">
  <div class="header-survey">
    <h1>SURVEY POTENSI KLASIS MAKALE UTARA</h1>
    <p>MEI 2025</p>
  </div>

  <div id="step-identitas">
    <h2>Form Responden</h2>
    <div class="question-card">
      <label class="question-text">NAMA :</label>
      <input type="text" id="resp_nama" placeholder="Masukkan nama lengkap...">
    </div>
    <div class="question-card">
      <label class="question-text">ASAL JEMAAT :</label>
      <select id="resp_jemaat">
        <option value="">-- Pilih Jemaat --</option>
        <option value="SILO BARANI">SILO BARANI</option>
        <option value="TBR">TBR</option>
        <option value="BUNGIN">BUNGIN</option>
        <option value="RTM">RTM</option>
        <option value="K. A'GASINGAN">K. A'GASINGAN</option>
        <option value="CK SIPATE">CK SIPATE</option>
        <option value="PNIEL SIGUNTU">PNIEL SIGUNTU</option>
        <option value="MARANATHA LUAK">MARANATHA LUAK</option>
        <option value="P.T. BONTONGAN">P.T. BONTONGAN</option>
      </select>
    </div>
    <button onclick="startSurvey()">Lanjutkan</button>
  </div>

  <form id="main-survey" class="hidden">
    <div id="questions-container">
      </div>
    <button type="button" onclick="submitSurvey()" id="btn-submit">Kirim Semua Jawaban</button>
  </form>
</div>

<script>
// Data Pertanyaan & Konfigurasi Logika
const specialQuestions = {
  // Tipe 1: Jika C, muncul sub-pilihan a,b,c,d
  type_sub: [1, 2, 3, 13, 17, 50],
  // Tipe 2: Selalu muncul kolom alasan
  type_reason_always: [24, 25, 26, 27],
  // Tipe 3: Jika C, muncul kolom alasan
  type_reason_cond: [28, 37, 42]
};

function startSurvey() {
  const nama = document.getElementById('resp_nama').value;
  const jemaat = document.getElementById('resp_jemaat').value;
  
  if(!nama || !jemaat) {
    alert("Mohon lengkapi Nama dan Asal Jemaat.");
    return;
  }
  
  document.getElementById('step-identitas').classList.add('hidden');
  document.getElementById('main-survey').classList.remove('hidden');
  generateQuestions();
}

function generateQuestions() {
  const container = document.getElementById('questions-container');
  // Contoh implementasi untuk beberapa soal pertama (Anda bisa melengkapinya di array)
  // Karena keterbatasan panjang teks, saya buatkan kerangka logic otomatisnya:
  
  const qData = [
    { id: 1, text: "Apakah anda mengetahui bahwa dalam merancang arah Gereja Toraja tahun 2021-2026 menggunakan pendekatan berbasis potensi (Appreciative Inquiry)?", ops: ["Ya", "Ragu-ragu", "Tidak"] },
    { id: 2, text: "Apakah Anda mengetahui bahwa sebelum SSA XXV di Kanuruan, Gereja Toraja menggunakan SWOT?", ops: ["Ya", "Ragu-ragu", "Tidak"] },
    // ... tambahkan soal lainnya di sini ...
    { id: 24, text: "Apakah program kesehatan telah diprogramkan di jemaat?", ops: ["Ya ada", "Tidak ada"] },
    { id: 28, text: "Apakah komisi diakonia jemaat Anda telah memprogramkan pelayanan bidang ekonomi?", ops: ["Ya", "Sudah program tapi belum jalan", "Tidak/Belum pernah"] }
  ];

  qData.forEach(q => {
    let html = `
      <div class="question-card">
        <span class="question-text">${q.id}. ${q.text}</span>
        <div class="options-group">
          ${q.ops.map((opt, index) => {
            const val = String.fromCharCode(97 + index); // a, b, c...
            return `
              <label class="option-item">
                <input type="radio" name="q${q.id}" value="${val}" 
                  onchange="handleLogic(${q.id}, '${val}')"> ${val}. ${opt}
              </label>
            `;
          }).join('')}
        </div>
        
        ${specialQuestions.type_sub.includes(q.id) ? `
          <div id="sub_pilihan_${q.id}" class="sub-panel hidden">
            <p><strong>Mengapa Anda tidak mengetahuinya?</strong></p>
            <label><input type="radio" name="sub_q${q.id}" value="a"> a. Tidak ada sosialisasi BPS</label><br>
            <label><input type="radio" name="sub_q${q.id}" value="b"> b. Tidak ada sosialisasi Wilayah</label><br>
            <label><input type="radio" name="sub_q${q.id}" value="c"> c. Tidak ada sosialisasi Klasis</label><br>
            <label><input type="radio" name="sub_q${q.id}" value="d"> d. Tidak ada sosialisasi Pendeta</label>
          </div>
        ` : ''}

        ${specialQuestions.type_reason_always.includes(q.id) ? `
          <div class="sub-panel">
            <label>Sebutkan alasannya / bentuknya:</label>
            <textarea name="reason_${q.id}" maxlength="300" placeholder="Maksimal 300 karakter..."></textarea>
          </div>
        ` : ''}

        ${specialQuestions.type_reason_cond.includes(q.id) ? `
          <div id="reason_panel_${q.id}" class="sub-panel hidden">
            <label>Jelaskan mengapa (Maks 300 Karakter):</label>
            <textarea name="reason_${q.id}" maxlength="300"></textarea>
          </div>
        ` : ''}
      </div>
    `;
    container.innerHTML += html;
  });
}

function handleLogic(qId, val) {
  // Logika Munculkan Sub Pilihan (Jika C)
  if(specialQuestions.type_sub.includes(qId)) {
    const el = document.getElementById(`sub_pilihan_${qId}`);
    val === 'c' ? el.classList.remove('hidden') : el.classList.add('hidden');
  }
  
  // Logika Munculkan Alasan (Jika C)
  if(specialQuestions.type_reason_cond.includes(qId)) {
    const el = document.getElementById(`reason_panel_${qId}`);
    val === 'c' ? el.classList.remove('hidden') : el.classList.add('hidden');
  }
}

function submitSurvey() {
  const form = document.getElementById('main-survey');
  const formData = new FormData(form);
  const data = {
    nama: document.getElementById('resp_nama').value,
    jemaat: document.getElementById('resp_jemaat').value,
    jawaban: {}
  };

  formData.forEach((value, key) => {
    data.jawaban[key] = value;
  });

  document.getElementById('btn-submit').innerText = "Mengirim...";
  document.getElementById('btn-submit').disabled = true;

  google.script.run.withSuccessHandler(res => {
    alert("Data berhasil disimpan! Terima kasih.");
    google.script.host.close();
  }).processForm(data);
}
</script>
</body>
</html>
